@c ===========================================================================
@c
@c This file was generated with po4a. Translate the source file.
@c
@c ===========================================================================
@c This is part of the Emacs manual.  -*- coding: utf-8 -*-
@c Copyright (C) 1985-1987, 1993-1995, 1997, 2000-2015 Free Software
@c Foundation, Inc.
@c See file emacs.texi for copying conditions.
@node Calendar/Diary
@chapter カレンダーとダイアリー
@cindex calendar
@findex calendar

  Emacsは、過去のイベントや将来のプランのためのダイアリーをもつ、卓上カレンダー機能を提供します。これにはアポイントメントを管理したり、特定のプロジェクトにどれだけ時間を費やしているか追跡する機能もあります。

  カレンダーを起動するには、@kbd{M-x
calendar}とタイプします。これは3ヶ月分のカレンダーを表示します。当月が中央に表示され、今日の日付にポイントが配されます。@kbd{C-u
M-x
calendar}のように数引数を指定すると、3ヶ月カレンダーの中央に表示する、月と年の入力を求めます。カレンダーは自身のバッファーを使用し、メジャーモードはCalendarモードです。

  カレンダーの中で@kbd{Mouse-3}をクリックすると、特定の日付にたいする操作メニューが表示されます。@kbd{Mouse-2}をクリックすると、特定の日付とは関係のない、一般的に使用されるカレンダー機能のメニューが表示されます。カレンダーを終了するには、@kbd{q}とタイプします。

@iftex
  このチャプターでは、基本的なカレンダー機能を説明します。より進んだトピックについては、@ref{Advanced Calendar/Diary
Usage,,, emacs-xtra, Specialized Emacs Features}を参照してください。
@end iftex

@menu
* Calendar Motion::          カレンダー内の移動、日付の選択。
* Scroll Calendar::          過去または将来の月をスクリーンに表示する。
* Counting Days::            2つの日付の間の日数は?
* General Calendar::         カレンダーの終了と再計算。
* Writing Calendar Files::   さまざまなフォーマットで、カレンダーをファイルに書き込む。
* Holidays::                 休日の日付を表示する。
* Sunrise/Sunset::           日の出と日の入りの時間を地方時間で表示する。
* Lunar Phases::             月の位相の表示。
* Other Calendars::          他のカレンダーシステムへの日付の変換。
* Diary::                    ダイアリーからイベントを表示する。
* Appointments::             何かを行なう時刻のためのリマインダー。
* Importing Diary::          ダイアリーのイベントと他のフォーマットの変換。
* Daylight Saving::          夏時間がアクティブな期間を指定する方法。
* Time Intervals::           時間間隔の追跡。
@ifnottex
* Advanced Calendar/Diary Usage:: カレンダーとダイアリーの上級のカスタマイズ。
@end ifnottex
@end menu

@node Calendar Motion
@section カレンダーでの移動

@cindex moving inside the calendar
  Calendarモードは日、週、月、年のような論理的な単位で、カレンダーを移動するコマンドを提供します。最初に表示されている3ヶ月の外に移動すると、カレンダーの表示は選択された日付が表示されるように、自動的に``スクロール''します。ある日付に移動することにより、その日が何の休日かを表示したり、ダイアリーのエントリーを表示したり、他のカレンダーに変換できます。単にカレンダーをスクロールするのは、長い期間を移動するのにも便利です。

@menu
* Calendar Unit Motion::     日、週、月、年単位での移動。
* Move to Beginning or End::  週、月、年の開始と終了への移動。
* Specified Dates::          今日の日付や、特定の日付への移動。
@end menu

@node Calendar Unit Motion
@subsection 標準的な時間間隔での移動

  カレンダーバッファーでの移動コマンドは、テキスト内での移動コマンドと似ています。日、週、月、年を前方および後方に移動できます。

@table @kbd
@item C-f
ポイントを、1日前方に移動します(@code{calendar-forward-day})。
@item C-b
ポイントを、1日後方に移動します(@code{calendar-backward-day})。
@item C-n
ポイントを、1週前方に移動します(@code{calendar-forward-week})。
@item C-p
ポイントを、1週後方に移動します(@code{calendar-backward-week})。
@item M-@}
ポイントを、1月前方に移動します(@code{calendar-forward-month})。
@item M-@{
ポイントを、1月後方に移動します(@code{calendar-backward-month})。
@item C-x ]
ポイントを、1年前方に移動します(@code{calendar-forward-year})。
@item C-x [
ポイントを、1年後方に移動します(@code{calendar-backward-year})。
@end table

@kindex C-f @r{(Calendar mode)}
@findex calendar-forward-day
@kindex C-b @r{(Calendar mode)}
@findex calendar-backward-day
@kindex C-n @r{(Calendar mode)}
@findex calendar-forward-week
@kindex C-p @r{(Calendar mode)}
@findex calendar-backward-week
  dayおよびweekのコマンドは、文字単位または行単位で移動するためのEmacsコマンド、自然に類似しています。通常@kbd{C-n}は、後続の行の同じ列に移動しますが、Calendarモードでは翌週の同じ日に移動します。@kbd{C-p}は、前の週の同じ日に移動します。

  他のモードで通常振る舞うように、矢印キーは@kbd{C-f}、@kbd{C-b}、@kbd{C-n}、@kbd{C-p}と等価です。

@kindex M-@} @r{(Calendar mode)}
@findex calendar-forward-month
@kindex M-@{ @r{(Calendar mode)}
@findex calendar-backward-month
@kindex C-x ] @r{(Calendar mode)}
@findex calendar-forward-year
@kindex C-x [ @r{(Calendar mode)}
@findex calendar-forward-year
  月単位および年単位の移動のためのコマンドは、週単位の移動コマンドに似ていますが、より長い期間を移動します。monthコマンドの@kbd{M-@}}および@kbd{M-@{}は、月全体を前方または後方に移動します。yearコマンドの@kbd{C-x
]}および@w{@kbd{C-x [}}は、年全体を前方または後方に移動します。

  これらのコマンドを簡単に覚える方法は、月および年が、テキストのパラグラフとページに類似するものだと考えることです。しかしコマンド自体は完全に類似している訳ではありません。Emacsのパラグラフコマンドは通常、パラグラフの先頭または最後に移動しますが、月コマンドと年コマンドは、月または年の同じ日を保ちながら、月単位または年単位で移動します。

  これらのコマンドは、繰り返し回数として数引数を受け取ります。Calendarモードでは便宜上、メタ修飾なしの数字キーとマイナス記号で、数引数を指定できます。たとえば@kbd{100
C-f}は、現在の位置から100日前方へポイントを移動します。

@node Move to Beginning or End
@subsection 週、月、年の開始と終了

  週(または月や年)は、単に日が集まったものではなく、特定に日付から開始されると考えます。そのためCalendarモードは週、月、年の、最初と最後に移動するコマンドを提供します。

@table @kbd
@kindex C-a @r{(Calendar mode)}
@findex calendar-beginning-of-week
@item C-a
週の最初にポイントを移動します(@code{calendar-beginning-of-week})。
@kindex C-e @r{(Calendar mode)}
@findex calendar-end-of-week
@item C-e
週の最後にポイントを移動します(@code{calendar-end-of-week})。
@kindex M-a @r{(Calendar mode)}
@findex calendar-beginning-of-month
@item M-a
月の最初にポイントを移動します(@code{calendar-beginning-of-month})。
@kindex M-e @r{(Calendar mode)}
@findex calendar-end-of-month
@item M-e
月の最後にポイントを移動します(@code{calendar-end-of-month})。
@kindex M-< @r{(Calendar mode)}
@findex calendar-beginning-of-year
@item M-<
年の最初にポイントを移動します(@code{calendar-beginning-of-year})。
@kindex M-> @r{(Calendar mode)}
@findex calendar-end-of-year
@item M->
年の最後にポイントを移動します(@code{calendar-end-of-year})。
@end table

  これらのコマンドは繰り返し回数として数引数を受け取り、繰り返し回数で、何週、何ヶ月、何年前方または後方へ移動するかを示します。

@vindex calendar-week-start-day
@cindex weeks, which day they start on
@cindex calendar, first day of week
  デフォルトでは、週は日曜日から開始されます。週が月曜日から開始されるようにするには、変数@code{calendar-week-start-day}を1にセットしてください。

@node Specified Dates
@subsection 日付の指定

  Calendarモードは、さまざまな方法で、指定された特定の日付へ移動するコマンドを提供します。

@table @kbd
@item g d
指定した日付にポイントを移動します(@code{calendar-goto-date})。
@item g D
年の指定された日にポイントを移動します(@code{calendar-goto-day-of-year})。
@item g w
年の指定された週にポイントを移動します(@code{calendar-iso-goto-week})。
@item o
指定された月をカレンダーの中央にします(@code{calendar-other-month})。
@item .
今日の日付にポイントを移動します(@code{calendar-goto-today})。
@end table

@kindex g d @r{(Calendar mode)}
@findex calendar-goto-date
  @kbd{g d}
(@code{calendar-goto-date})は年、月、月の何日目かの入力を求め、その日付に移動します。カレンダーは西暦の最初からすべての日付を含むので、年は全部タイプしなければなりません。つまり、@samp{90}ではなく@samp{1990}とタイプします。

@kindex g D @r{(Calendar mode)}
@findex calendar-goto-day-of-year
@kindex g w @r{(Calendar mode)}
@findex calendar-iso-goto-week
  @kbd{g D}
(@code{calendar-goto-day-of-year})は、年と日数の入力を求め、その日付に移動します。負の日数は年の最後から後方に数えます。@kbd{g
w} (@code{calendar-iso-goto-week})は、年と週数の入力を求め、その週に移動します。

@kindex o @r{(Calendar mode)}
@findex calendar-other-month
  @kbd{o} (@code{calendar-other-month})は、月と年の入力を求め、3ヶ月カレンダーの中央にその月を配します。

@kindex . @r{(Calendar mode)}
@findex calendar-goto-today
  @kbd{.}@: (@code{calendar-goto-today})で今日の日付に戻ることができます。

@node Scroll Calendar
@section カレンダーでのスクロール

@cindex scrolling in the calendar
  カレンダーの表示は、ポイントが表示部分の外に移動すると、自動的にスクロールします。手動でスクロールすることもできます。カレンダーのウィンドウに、月が書き込まれた細長い紙が含まれているのを想像してみてください。カレンダーのスクロールとは、この紙を水平方向に動かして、そのウィンドウに新しい月を表示することを意味します。

@table @kbd
@item >
カレンダーを1月前方にスクロールします(@code{calendar-scroll-left})。
@item <
カレンダーを1月後方にスクロールします(@code{calendar-scroll-right})。
@item C-v
@itemx @key{next}
カレンダーを3月前方にスクロールします(@code{calendar-scroll-left-three-months})。
@item M-v
@itemx @key{prior}
カレンダーを3月後方にスクロールします(@code{calendar-scroll-right-three-months})。
@end table

@kindex > @r{(Calendar mode)}
@findex calendar-scroll-left
@kindex < @r{(Calendar mode)}
@findex calendar-scroll-right
  もっとも基本的なカレンダーのスクロールコマンドは、1度に1月スクロールします。これはコマンドの前後の表示で、2月がオーバーラップして表示されることを意味します。@kbd{>}は内容を、1度に1月前方にスクロールします。@kbd{<}は内容を、1度に1月後方にスクロールします。

@kindex C-v @r{(Calendar mode)}
@findex calendar-scroll-left-three-months
@kindex M-v @r{(Calendar mode)}
@findex calendar-scroll-right-three-months
  コマンド@kbd{C-v}および@kbd{M-v}は、カレンダーを``画面全体'' ---
つまり3月スクロールします。この動作は、これらのコマンドが通常意味する動作と類似しています。@kbd{C-v}は後の日付を表示し、@kbd{M-v}は前の日付を表示します。これらのコマンドは、繰り返し回数として数引数を受け取ります。特に@kbd{C-u}は次のコマンドを4倍するので、@kbd{C-u
C-v}は1年前方にカレンダーをスクロールし、@kbd{C-u M-v}は1年後方にカレンダーをスクロールします。

  他のモードのときと同様に、ファンクションキーの@key{next}と@key{prior}は、@kbd{C-v}や@kbd{M-v}と等価です。

@node Counting Days
@section 日付のカウント

@table @kbd
@item M-=
カレントリージョン内の日数を表示します(@code{calendar-count-days-region})。
@end table

@kindex M-= @r{(Calendar mode)}
@findex calendar-count-days-region
  ある範囲の日数を数えるには、@kbd{C-@key{SPC}}で日付をマークし、他の日付にポイントを移動して、@kbd{M-=}
(@code{calendar-count-days-region})とタイプします。表示される日数は@emph{包括的(inclusive)}です。つまりマークとポイントで指定された日も、日数に含まれます。

@node General Calendar
@section その他のカレンダーコマンド

@table @kbd
@item p d
day-in-year(1年で何日目か)を表示します(@code{calendar-print-day-of-year})。
@item C-c C-l
カレンダーウィンドウを再生成します(@code{calendar-redraw})。
@item @key{SPC}
次のウィンドウを上にスクロールします(@code{scroll-other-window})。
@item @key{DEL}
@itemx S-@key{SPC}
次のウィンドウを下にスクロールします(@code{scroll-other-window-down})。
@item q
カレンダーをexitします(@code{calendar-exit})。
@end table

@kindex p d @r{(Calendar mode)}
@cindex day of year
@findex calendar-print-day-of-year
  年の初めからの経過日数と、年の最後までの残り日数を表示するには、@kbd{p d} command
(@code{calendar-print-day-of-year})とタイプします。これは、それら両方の日数をエコーエリアに表示します。経過日数には選択された日付も含まれます。残り日数に、その日は含まれません。

@kindex C-c C-l @r{(Calendar mode)}
@findex calendar-redraw
  カレンダーウィンドウのテキストがおかしくなった場合は、再描画するために@kbd{C-c C-l}
(@code{calendar-redraw})とタイプします(これはCalendarモード以外のモードの編集コマンドを使ったときだけ発生します)。

@kindex SPC @r{(Calendar mode)}
  Calendarモードでは、@key{SPC} (@code{scroll-other-window})と@key{DEL}
(@code{scroll-other-window-down})を使って、(もしあれば)他のウィンドウを上または下にスクロールします。これは休日のリストやダイアリーのエントリーを他のウィンドウに表示しているときなどに便利です。

@kindex q @r{(Calendar mode)}
@findex exit-calendar
@vindex calendar-remove-frame-by-deleting
  カレンダーからexitするには、@kbd{q}
(@code{calendar-exit})とタイプします。これはカレンダーに関連するすべてのバッファーを隠し(bury)、他のバッファーを選択します(フレームがカレンダー専用のウィンドウを含む場合、カレンダーをexitすることによりそのフレームは、削除またはアイコン化されます。これは変数@code{calendar-remove-frame-by-deleting}の値に依存します)。

@c FIXME this mentions holidays and diary entries, albeit briefly, so
@c should it be moved after those sections?  Or at least xref them.
@node Writing Calendar Files
@section カレンダーファイルの記述

  カレンダーとダイアリーのエントリーを、HTMLや@LaTeX{}に書き出すことができます。

@cindex calendar and HTML
  Calendar
HTMLコマンドは、カレンダー、休日、ダイアリーのエントリーを含む、HTMLコードのファイルを生成します。各ファイルは1ヶ月に対応し、@file{@var{yyyy}-@var{mm}.html}という形式の名前をもちます。ここで@var{yyyy}は4桁の年、@var{mm}は2桁の月です。変数@code{cal-html-directory}は、HTMLファイルのためのデフォルトの出力先ディレクトリーを指定します。休日が表示されないようにするには、@code{cal-html-holidays}をカスタマイズしてください。

@vindex cal-html-css-default
  @code{<}と@code{>}で囲まれたダイアリーのエントリー(たとえば、this is a diary entry with <font
color=''red''>some red
text</font>)は、HTMLタグと解釈されます。HTMLファイルを含むディレクトリーの中にあるスタイルシート@file{cal.css}を通じて、表示されるHTMLページの全体的な外観を変更できます(関連するスタイルセッティングについては、変数@code{cal-html-css-default}の値を参照してください)。

@kindex t @r{(Calendar mode)}
@table @kbd
@item H m
1ヶ月のカレンダーを生成します(@code{cal-html-cursor-month})。
@item H y
1年の各月のカレンダーファイルを生成し、同様にインデックスページも生成します(@code{cal-html-cursor-year})。デフォルトでは、このコマンドはファイルをサブディレクトリー@var{yyyy}に書き込みます。これを変更した場合、各年の間のハイパーリンクは機能しなくなるでしょう。
@end table

  変数@code{cal-html-print-day-number-flag}が非@code{nil}の場合、マンスリーカレンダーにはday-of-the-year(年の何日目か)の数字が表示されます。変数@code{cal-html-year-index-cols}は、年のインデックスページの列数を指定します。

@cindex calendar and @LaTeX{}
  Calendar
@LaTeX{}コマンドは、カレンダーとしてプリントされる@LaTeX{}コードのバッファーを生成します。どのコマンドを使うかにより、プリントされるカレンダーは、ポイントのある日、週、月、年をカバーします。

@kindex t @r{(Calendar mode)}
@table @kbd
@item t m
1ヶ月のカレンダーを生成します(@code{cal-tex-cursor-month})。
@item t M
横向き印刷(sideways-printing)で、1ヶ月のカレンダーを生成します(@code{cal-tex-cursor-month-landscape})。
@item t d
1日のカレンダーを生成します(@code{cal-tex-cursor-day})。
@item t w 1
時間を併記した、1週間の1ページカレンダーを生成します(@code{cal-tex-cursor-week})。
@item t w 2
時間を併記した、1週間の2ページカレンダーを生成します(@code{cal-tex-cursor-week2})。
@item t w 3
時間なしで、1週間のISOスタイルのカレンダーを生成します(@code{cal-tex-cursor-week-iso})。
@item t w 4
時間を併記した、月曜で始まる1週間のカレンダーを生成します(@code{cal-tex-cursor-week-monday})。
@item t w W
時間なしで、1週間の2ページカレンダーを生成します(@code{cal-tex-cursor-week2-summary})。
@item t f w
2週間を見開きする、Filofaxスタイルのカレンダーを生成します(@code{cal-tex-cursor-filofax-2week})。
@item t f W
1週間を見開きする、Filofaxスタイルのカレンダーを生成します(@code{cal-tex-cursor-filofax-week})。
@item t y
1年のカレンダーを生成します(@code{cal-tex-cursor-year})。
@item t Y
横向き印刷(sideways-printing)で、1年のカレンダーを生成します(@code{cal-tex-cursor-year-landscape})。
@item t f y
1年のFilofaxスタイルのカレンダーを生成します(@code{cal-tex-cursor-filofax-year})。
@end table

  これらのコマンドの中には、カレンダーを(``ランドスケープモード''で)横向きに印刷するものがあり、その場合は縦長ではなく横長になります。Filofaxの用紙サイズ(3.75in
x
6.75in)を使うものもあります。これらのコマンドはすべてプレフィクス引数を指定でき、これは何日、何週間、何ヶ月、何年分を印刷するかを指定します(常に選択された日付から開始されます)。

  変数@code{cal-tex-holidays}が非@code{nil}(デフォルト)の場合、プリンとされたカレンダーには@code{calendar-holidays}の休日が表示されます。変数@code{cal-tex-diary}が非@code{nil}(デフォルトは@code{nil})の場合、ダイアリーのエントリーも含まれます(マンスリー、filofax、isoの週カレンダーのみ)。変数@code{cal-tex-rules}が非@code{nil}(デフォルトは@code{nil})の場合、カレンダーは充分な空間のある、罫線ページのスタイルで表示されます。そのカレンダーがどんな機能をサポートするかは、個別のcal-tex関数のドキュメントを参照してください。

  必要なら、変数@code{cal-tex-preamble-extra}を使用して、生成されたドキュメントのプリアンブル(preamble)に、追加の@LaTeX{}コマンドを挿入できます。

@node Holidays
@section 休日
@cindex holidays

  Emacsのカレンダーは、多くのメジャーおよびマイナーな休日を知っており、それらを表示することができます。デフォルトリストに、あなた自身の休日を追加できます。

@table @kbd
@item Mouse-3 Holidays
@itemx h
選択された日付の休日を表示します(@code{calendar-cursor-holidays})。
@item x
カレンダーウィンドウの休日をマークします(@code{calendar-mark-holidays})。
@item u
カレンダーウィンドウのマークを外します(@code{calendar-unmark})。
@item a
表示された3ヶ月の休日を別のウィンドウにリストします(@code{calendar-list-holidays})。
@item M-x holidays
今日を含む3ヶ月の休日を別のウィンドウにリストします。
@item M-x list-holidays
年の指定した範囲の休日を別のウィンドウにリストします。
@end table

@kindex h @r{(Calendar mode)}
@findex calendar-cursor-holidays
@vindex calendar-view-holidays-initially-flag
  ある日付が休日かどうか見るには、カレンダーウィンドウのその日付にポイントを置いて、@kbd{h}コマンドを使用します。その日付を@kbd{Mouse-3}でクリックして表示されるメニューで、@kbd{Holidays}を選択しても見ることができます。どちらの方法も、その日付にたいする休日を、エコーエリアか、エコーエリアに収まらない場合は別のウィンドウに表示します。

@kindex x @r{(Calendar mode)}
@findex calendar-mark-holidays
@kindex u @r{(Calendar mode)}
@findex calendar-unmark
@vindex calendar-mark-holidays-flag
  カレンダーに表示された、すべての日付にたいする休日の分布を閲覧するには、@kbd{x}コマンドを使用します。これは休日を異なるフェイスで表示します。
@iftex
@ref{Calendar Customizing,,, emacs-xtra, Specialized Emacs
Features}を参照してください。
@end iftex
@ifnottex
@ref{Calendar Customizing, calendar-holiday-marker}を参照してください。
@end ifnottex
  このコマンドは、現在表示されている月と、スクロールすることにより見ることができる他の月の両方に適用されます。マークをオフにして現在のマークを消すには、@kbd{u}をタイプします。これはダイアリーマークも消します(@ref{Diary}を参照してください)。変数@code{calendar-mark-holidays-flag}が非@code{nil}の場合、カレンダーの作成または更新により、自動的に休日がマークされます。

@kindex a @r{(Calendar mode)}
@findex calendar-list-holidays
  さらに詳細な情報を得るには、@kbd{a}コマンドを使用します。これはカレントの3ヶ月の範囲のすべての休日を含むリストを、別のバッファーに表示します。カレンダーウィンドウで@key{SPC}および@key{DEL}を使用することにより、そのリストを上または下にスクロールできます。

@findex holidays
  コマンド@kbd{M-x
holidays}は、今月および前月と来月の休日のリストを表示します。これはカレンダーウィンドウがないときでも機能します。変数@code{calendar-view-holidays-initially-flag}が非@code{nil}の場合、カレンダーの作成により、休日がこの方法で表示されます。違う月を中心にした3ヶ月の休日リストが欲しい場合は、月と年の入力を求める@kbd{C-u
M-x holidays}を使用してください。

  Emaceが知っている休日には、United States、major
Bahá'í、Chinese、Christian、Islamic、Jewishの休日、および夏至と冬至(solstices)、春分と秋分(equinoxes)が含まれます。

@findex list-holidays
   @kbd{M-x
holiday-list}は、ある年の範囲にたいする休日のリストを表示します。この関数は年の開始と終了の入力を求め、すべての休日、または複数のカテゴリーの中の1つのカテゴリーに属する休日を選択することができます。このコマンドは、カレンダーウィンドウがないときでも使用することができます。

  休日に使用される日付は、歴史的事実ではなく、@emph{現在の慣習(current practice)}にもとづきます。たとえばVeteran's
Day(退役軍人の日)は1919年に始まった休日ですが、それより前の年でも表示されます。

@node Sunrise/Sunset
@section 日の出と日の入りの時刻
@cindex sunrise and sunset

  特別なカレンダーコマンドにより、任意の日付にたいする日の出(sunrise)と日の入り(sunset)の時刻を、1、2分の範囲で調べることができます。

@table @kbd
@item Mouse-3 Sunrise/sunset
@itemx S
選択された日付の、日の出と日の入りの時刻を表示します(@code{calendar-sunrise-sunset})。
@item M-x sunrise-sunset
今日の日の出と日の入りの時刻を表示します。
@item C-u M-x sunrise-sunset
指定した日付の日の出と日の入りの時刻を表示します。
@item M-x calendar-sunrise-sunset-month
選択された月の日の出と日の入りの時刻を表示します。
@end table

@kindex S @r{(Calendar mode)}
@findex calendar-sunrise-sunset
@findex sunrise-sunset
  カレンダーからは、見たい日付にポイントを移動して@kbd{S}をタイプすると、エコーエリアに日の出と日の入りの時刻を、@emph{地方時間}で表示します。日付を@kbd{Mouse-3}でクリックし、表示されたメニューの@samp{Sunrise/sunset}を選択しても表示することができます。今日、または指定した日付にたいしてこの情報を表示するために、カレンダーの外からでも、コマンド@kbd{M-x
sunrise-sunset}が利用可能です。今日以外の日付を指定するには、年、月、日の入力を求める@kbd{C-u M-x
sunrise-sunset}を使用してください。

  @kbd{C-u C-u M-x
sunrise-sunset}により、任意の地域の任意の日付にたいして、日の出と日の入りの時刻を表示できます。これは経度(longitude)、緯度(latitude)、調整済みグリニッジ平均時(Coordinated
Universal Time)との分差、日付の入力を求め、その地域の、その日付の日の出と日の入りの時刻を表示します。

  日の出と日の入りの時刻は地球上の位置に依存するので、これらのコマンドを使用する前に、Emacsに経度(latitude)、緯度(longitude)、地域名(location
name)を指定する必要があります。以下は何をセットするかの例です:

@vindex calendar-location-name
@vindex calendar-longitude
@vindex calendar-latitude
@example
(setq calendar-latitude 40.1)
(setq calendar-longitude -88.2)
(setq calendar-location-name "Urbana, IL")
@end example

@noindent
@code{calendar-latitude}と@code{calendar-longitude}には、小数点以下1位までの数値を使用します。

  タイムゾーン(time
zone)も、地方時間での日の入りと日の出の時刻に影響を与えます。Emacsは通常、タイムゾーンの情報をオペレーティングシステムから得ますが、その情報が間違っている場合(またはオペレーティングシステムがその情報を提供しない場合)、これらを自分でセットしなければなりません。以下は例です:

@vindex calendar-time-zone
@vindex calendar-standard-time-zone-name
@vindex calendar-daylight-time-zone-name
@example
(setq calendar-time-zone -360)
(setq calendar-standard-time-zone-name "CST")
(setq calendar-daylight-time-zone-name "CDT")
@end example

@noindent
@code{calendar-time-zone}の値は地方標準時(local standard
time)と、調整済みグリニッジ平均時(Coordinated Universal Time)、またはグリニッジ時(Greenwich time:
GMT)との分差です。@code{calendar-standard-time-zone-name}と@code{calendar-daylight-time-zone-name}の値は、あなたのタイムゾーンで使用される略語です。Emacsは、@emph{サマータイム(daylight
saving time)}で調整済みの、日の出と日の入りの時刻を表示します。サマータイムが決定される方法については、@ref{Daylight
Saving}を参照してください。

  ユーザーとしては@file{.emacs}で、普段いる場所をカレンダーの位置変数にセットすると便利だと思うかもしれません。システム管理者としては、@file{default.el}で、すべてのユーザーにたいして、これらの変数をセットしたいと思うかもしれません。@ref{Init
File}を参照してください。

@node Lunar Phases
@section 月の位相
@cindex phases of the moon
@cindex moon, phases of

  以下のカレンダーコマンドは、月の位相(phases of the moon)、つまり新月(new moon)、上弦(first
quarter)、満月(full moon)、下弦(last
quarter)の日付と時刻を表示します。この機能は、``月の位相に依存する''問題をデバッグするのに便利です。

@table @kbd
@item M
表示されている3ヶ月にたいして、月のすべての4位相の日付と時刻を表示します(@code{calendar-lunar-phases})。
@item M-x lunar-phases
今日を含む3ヶ月にたいして、月のすべての4位相の日付と時刻を表示します。
@end table

@kindex M @r{(Calendar mode)}
@findex calendar-lunar-phases
  カレンダーからは@kbd{M}を使用して、カレントの3ヶ月の範囲での月の位相を、別のバッファーに表示します。数分の誤差で、日付と時刻がリストされます。

@findex lunar-phases
  カレンダーの外からは、コマンド@kbd{M-x
lunar-phases}で今月と前後1ヶ月の、月の位相のリストが表示されます。違う月についての情報は、月と年の入力を求める@kbd{C-u M-x
lunar-phases}を使用してください。

  月の位相にたいして与えられる日付と時刻は、(それが適切なときはサマータイム調整されて)地方時間で与えられます。前のセクションの議論を参照してください。@ref{Sunrise/Sunset}を参照してください。

@node Other Calendars
@section 他のカレンダーとの間の変換

@cindex Gregorian calendar
  Emacsのカレンダーは、@emph{常に}グレゴリオ暦(Gregorian
calendar)で表示されます。これは、``新しいスタイル''のカレンダーと呼ばれることもあり、今日では世界のほとんどで使用されています。しかし、このカレンダーは16世紀より前には存在しておらず、、18世紀より前は広く使われていませんでした。ユリウス暦(Julian
calendar)を置き換えて、世界的に受け入れられたのも20世紀初頭です。Emacsカレンダーは、西暦1年1月から任意の月を表示できますが、グレゴリオ歴がまだ存在しない日付にたいしても、カレンダーは常にグレゴリオ暦で表示されます。

  Emacsは他のカレンダーを表示できませんが、日付を他のカレンダーに変換することができます。

@menu
* Calendar Systems::         (グレゴリオ歴以外の)Emacsが理解するカレンダー。
* To Other Calendar::        選択された日付をさまざまなカレンダーに変換する。
* From Other Calendar::      他のカレンダーで指定された日付に移動する。
@end menu

@c FIXME perhaps most of the details should be moved to cal-xtra.
@c Just list the major supported systems here?
@node Calendar Systems
@subsection サポートされるカレンダーシステム

@cindex ISO commercial calendar
  ISO商用暦(ISO commercial calendar)は、ビジネスで使われることがあります。

@cindex Julian calendar
  ユリウス暦(Julian calendar)は、ジュリアス・シーザー(Julius
Caesar)から名前がつけられたカレンダーで、中世ヨーロッパで使用され、19世紀まで多くの国で使用されてきました。

@cindex Julian day numbers
@cindex astronomical day numbers
  天文学者は、ユリウス歴のB.C.4713年1月1日正午からの、単純な通算日を使用します。この経過日は@dfn{ユリウス日(Julian day:
JD)}、または@dfn{天文日(Astronomical day)}と呼ばれます。

@cindex Hebrew calendar
  ヘブライ暦(Hebrew calendar)は伝統的にユダヤ教(Jewish
religion)で使用されます。EmacsのカレンダープログラムはJewishの休日を決定するためにヘブライ暦を使用します。ヘブライ暦では日没が1日の開始と終了です。

@cindex Islamic calendar
  イスラム暦(Islamic
calendar)は、主にIslamic国で広く使用されます。EmacsはIslamicの休日の日付を決定するのに、これを使用します。Islamicの世界では、カレンダーについての世界的な取り決めが存在しません。Emacsは広く受け入れられているバージョンを使用しますが、Islamicの休日の正確な日付は、計算によってではなく、宗教的な権威による公告に依存することがしばしばあります。結果として、行事の正確な日付はEmacsが計算する日付と若干違う場合があります。イスラム暦では、日没が1日の開始と終了です。

@cindex French Revolutionary calendar
  フランス革命暦(French Revolutionary
calendar)は、より非宗教的で自然にもとづいた観点により1年のサイクルを表すために、1789年の革命後にジャコバン派(Jacobins)により作成されました。これはメートル法のような、合理的な目安により1週が10日に設定されます。フランス政府は1805年の終わりに、このカレンダーを公式に放棄しました。

@cindex Mayan calendar
  中央アメリカのマヤには、互いに個別で重複した3つのカレンダーシステム@emph{long
count}、@emph{tzolkin}、@emph{haab}があります。Emacsはこれら3つのカレンダーすべてを知っています。専門家はマヤのカレンダーと私たちのカレンダーとの正確な関連を議論しています。Emacsは、Goodman-Martinez-Thompsonの相関関係を使用して計算を行ないます。

@cindex Coptic calendar
@cindex Ethiopic calendar
  コプト教徒(Copts:
エジプト教会のクリスチャン)は、エジプト古代の太陽暦にもとづいたカレンダーを使用します。彼らのカレンダーは30日からなる12の月と、その後に余分の5日が含まれます。4年に1度、余分な5日に閏日を加えて6日とします。エチオピア暦は構造的に同じですが、異なる年数と月の名前をもちます。

@cindex Persian calendar
@c FIXME not so far in the future now.
  ペルシャ人は、Omar
Khayyamのデザインにもとづく太陽暦を使用します。かれらのカレンダーは12の月を含み、最初の6ヶ月は31日、次の5ヶ月は30日、最後の月は、通常の年は29日で、閏年は30日です。閏年は4年または5年後との複雑なパターンで発生します。ここで実装されているカレンダーは、Birashkにより指示されている数学的なペルシャ歴で、2820年周期にもとづいています。天文学的なペルシャ暦との違いは、それが天文学的なイベントにもとづいている点です。これを記述している時点で、2つの歴に最初に矛盾が発生すると予測されるのは、2025年の3月20日です。現時点では、そのときのイランの公式カレンダーが何になるかは、明確ではありません。

@cindex Chinese calendar
  旧暦(Chinese
calendar)は、太陽年に太陰月を組み込んだ複雑なシステムです。年は60周期で、各年は通常の年は12ヶ月、閏年は13ヶ月です。各月は通常の月は29日または30日です。年、通常月、日は10の``celestial
stems''と、12の``terrestrial
branches''の組み合わせにより名前がつけられ、これが合計で60個の名前となり、60回周期で繰り返されます。

@cindex Bahá'í calendar
  Bahá'íのカレンダーシステムは、19日を持つ19ヶ月の太陽周期にもとづきます。のこり4日の``閏日(intercalary
days)''は、18ヶ月目と19ヶ月目の間に配されます。

@node To Other Calendar
@subsection 他のカレンダーへの変換

  以下のコマンドは、選択された日付(ポイント位置の日付)をさまざまなカレンダーシステムで記述します:

@table @kbd
@kindex p @r{(Calendar mode)}
@findex calendar-print-other-dates
@item Mouse-3  Other calendars
@itemx p o
選択された日付を、他のさまざまなカレンダーで表示します(@code{calendar-print-other-dates})。
@findex calendar-iso-print-date
@item p c
選択された日付を、ISO商用暦(ISO commercial
calendar)で表示します(@code{calendar-iso-print-date})。
@findex calendar-julian-print-date
@item p j
選択された日付を、ユリウス日(Julian date)で表示します(@code{calendar-julian-print-date})。
@findex calendar-astro-print-day-number
@item p a
選択された日付を、ユリウス日にもとづく天文日(astronomical
day)で表示します(@code{calendar-astro-print-day-number})。
@findex calendar-hebrew-print-date
@item p h
選択された日付を、ヘブライ暦の日付(Hebrew date)で表示します(@code{calendar-hebrew-print-date})。
@findex calendar-islamic-print-date
@item p i
選択された日付を、イスラム暦の日付(Islamic date)で表示します(@code{calendar-islamic-print-date})。
@findex calendar-french-print-date
@item p f
選択された日付を、フランス革命暦の日付(French Revolutionary
date)で表示します(@code{calendar-french-print-date})。
@findex calendar-bahai-print-date
@item p b
選択された日付を、Bahá'í dateで表示します(@code{calendar-bahai-print-date})。
@findex calendar-chinese-print-date
@item p C
選択された日付を、旧暦の日付(Chinese date)で表示します(@code{calendar-chinese-print-date})。
@findex calendar-coptic-print-date
@item p k
選択された日付を、Coptic dateで表示します(@code{calendar-coptic-print-date})。
@findex calendar-ethiopic-print-date
@item p e
選択された日付を、Ethiopic dateで表示します(@code{calendar-ethiopic-print-date})。
@findex calendar-persian-print-date
@item p p
選択された日付を、ペルシャ暦の日付(Persian date)で表示します(@code{calendar-persian-print-date})。
@findex calendar-mayan-print-date
@item p m
選択された日付を、マヤ暦の日付(Mayan date)で表示します(@code{calendar-mayan-print-date})。
@end table

  変換したい日付にポイントを移動して、上記のテーブルから@kbd{p}で始まる適切なコマンドをタイプします。プレフィクスの@kbd{p}は、``print''のニーモニックです。これは、Emacsが」変換した日付を、エコーエリアに``プリント''するからです。@kbd{p
o}は日付を、Emacsが知るすべての形式で表示します。@kbd{Mouse-3}でクリックして表示されるメニューから、@kbd{Other
calendars}を選択することもできます。これは、日付をEmacsが知るすべての形式でメニュー形式で表示します(メニュー形式で表示されるさまざまな形式の日付を選択しても、何もおこりません。この場合、メニューは表示のためだけに使用されます)。

@node From Other Calendar
@subsection 他のカレンダーからの変換

  サポートされている他のカレンダーで日付を指定して、その日付に移動することができます。このセクションでは、マヤ暦以外のカレンダーを使用してこれを行なうコマンドを説明します。マヤ暦については、以降のセクションを参照してください。

@kindex g @var{char} @r{(Calendar mode)}
@findex calendar-iso-goto-date
@findex calendar-iso-goto-week
@findex calendar-julian-goto-date
@findex calendar-astro-goto-day-number
@findex calendar-bahai-goto-date
@findex calendar-hebrew-goto-date
@findex calendar-islamic-goto-date
@findex calendar-french-goto-date
@findex calendar-chinese-goto-date
@findex calendar-persian-goto-date
@findex calendar-coptic-goto-date
@findex calendar-ethiopic-goto-date
@table @kbd
@item g c
ISO商用暦(ISO commercial
calendar)で指定された日付に移動します(@code{calendar-iso-goto-date})。
@item g w
ISO商用暦で指定された週に移動します(@code{calendar-iso-goto-week})。
@item g j
ユリウス暦(Julian calendar)で指定された日付に移動します(@code{calendar-julian-goto-date})。
@item g a
ユリウス暦にもとづく天文日で指定された日付に移動します(@code{calendar-astro-goto-day-number})。
@item g b
Bahá'í calendarで指定された日付に移動します(@code{calendar-bahai-goto-date})。
@item g h
ヘブライ暦(Hebrew calendar)で指定された日付に移動します(@code{calendar-hebrew-goto-date})。
@item g i
イスラム暦(Islamic calendar)で指定された日付に移動します(@code{calendar-islamic-goto-date})。
@item g f
フランス革命暦(French Revolutionary
calendar)で指定された日付に移動します(@code{calendar-french-goto-date})。
@item g C
旧暦(Chinese calendar)で指定された日付に移動します(@code{calendar-chinese-goto-date})。
@item g p
ペルシャ暦(Persian calendar)で指定された日付に移動します(@code{calendar-persian-goto-date})。
@item g k
コプト暦(Coptic calendar)で指定された日付に移動します(@code{calendar-coptic-goto-date})。
@item g e
エチオピア暦(Ethiopic calendar)で指定された日付に移動します(@code{calendar-ethiopic-goto-date})。
@end table

  これらのコマンドは、他のカレンダーの日付の入力を求め、その日付と等価なグレゴリオ暦(Ethiopic
calendar)の日付に移動して、他のカレンダーの日付をエコーエリアに表示します。Emacsは月の名前を入力するとき、常に強い補完(@ref{Completion
Exit}を参照してください)を使うので、ヘブライ、イスラム、フランスの名前のスペルを心配する必要はありません。

@c FIXME move?
@findex calendar-hebrew-list-yahrzeits
@cindex yahrzeits
  ヘブライ暦に関する一般的な問題として、``yahrzeit''と呼ばれる死亡日にたいする記念日の計算があります。Emacsのカレンダーには、そのような計算の機能が含まれています。カレンダーにいるときは、コマンド@kbd{M-x
calendar-hebrew-list-yahrzeits}により、まず年の範囲の入力を求め、ポイント位置の日付により、それらの年のyahrzeitの日付のリストを表示します。カレンダーにいないときは、このコマンドは最初に死亡日、次に年の範囲の入力を求め、yahrzeitの日付の一覧を表示します。

@node Diary
@section ダイアリー
@cindex diary

  Emacsのダイアリーはカレンダーと共に、日常のアポイントメントやその他のイベントを管理します。ダイアリー機能を使うには、最初にイベントとその日付を含む@dfn{ダイアリーファイル(diary
file)}を作成しなければなりません。Emacsは今日、近い将来、指定された日付のイベントを自動的にピックアップして表示します。

  ダイアリーファイルの名前は、変数@code{diary-file}により指定されます。デフォルトは@file{~/diary}です。以下はこのファイルの例です:

@example
12/22/2012  Twentieth wedding anniversary!!
&1/1.       Happy New Year!
10/22       Ruth's birthday.
* 21, *:    Payday
Tuesday--weekly meeting with grad students at 10am
         Supowit, Shen, Bitner, and Kapoor to attend.
1/13/89     Friday the thirteenth!!
&thu 4pm    squash game with Lloyd.
mar 16      Dad's birthday
April 15, 2013 Income tax due.
&* 15       time cards due.
@end example

@noindent
このフォーマットは、いくつかのUnixシステムで提供されている、別の@command{calendar}ユーティリティーで使用されるものと、基本的に同じです。この例では、ほとんどのエントリーにたいして、余分なスペースでイベント説明を位置揃えしています。このようなフォーマットは、純粋に好みの問題です。

  ダイアリーの作成を手作業で行なおうと考えているかもしれませんが、Emacsはダイアリーのエントリーを閲覧、追加、変更するいくつかのコマンドを提供します。

@menu
* Displaying the Diary::     ダイアリーのエントリーと、それに関連するカレンダーの日付を閲覧する。
* Format of Diary File::     ダイアリーにイベントを入力する。
* Date Formats::             日付を指定するさまざまな方法。
* Adding to Diary::          ダイアリーのエントリーを作成するコマンド。
* Special Diary Entries::    記念日、日付ブロック、周期的なエントリーなど。
@end menu

@node Displaying the Diary
@subsection ダイアリーの表示

  1度ダイアリーファイルを作成すると、カレンダーを使ってそれを閲覧できます。Calendarモードの外で、今日のイベントを閲覧することもできます。以下はCalendarバッファーで参照されるキーバインドです。

@table @kbd
@item Mouse-3 Diary
@itemx d
選択された日付の、すべてのダイアリーエントリーを表示します(@code{diary-view-entries})。
@item s
ダイアリーファイル全体を表示します(@code{diary-show-all-entries})。
@item m
表示されている日付で、ダイアリーエントリーをもつものをすべてマークします(@code{diary-mark-entries})。
@item u
カレンダーウィンドウのマークを外します(@code{calendar-unmark})。
@item M-x diary-print-entries
表示されているダイアリーのハードコピーを印刷します。
@item M-x diary
今日の日付の、すべてのダイアリーエントリーを表示します。
@item M-x diary-mail-entries
近づきつつあるダイアリーエントリーのリマインダーとして、あなた自身にメールします。
@end table

@kindex d @r{(Calendar mode)}
@findex diary-view-entries
@vindex calendar-view-diary-initially-flag
  @kbd{d}でダイアリーエントリーを表示すると、カレンダーで選択された日付のダイアリーエントリーが別のウィンドウで表示されます。新しいウィンドウのモードラインには、ダイアリーエントリーの日付が表示されます。休日はバッファーとモードラインの両方で表示され、それは選択した表示方法に依存します
@iftex
(@ref{Diary Display,,, emacs-xtra, Specialized Emacs Features}を参照してください)。
@end iftex
@ifnottex
(@ref{Diary Display}を参照してください)。
@end ifnottex
@kbd{d}に数引数を指定した場合、選択した日付から指定した日数までのすべてのダイアリーエントリーを表示します。したがって、@kbd{2
d}は選択された日と、その次の日のすべてのエントリーを表示します。

  ある日付にたいするダイアリーエントリーを表示する別の方法は、日付を@kbd{Mouse-3}でクリックして、表示されるメニューから@kbd{Diary
entries}を選択する方法です。変数@code{calendar-view-diary-initially-flag}が非@code{nil}の場合、カレンダーの作成により、その日のダイアリーエントリーがリストされます(その日が表示されている場合)。

@kindex m @r{(Calendar mode)}
@findex diary-mark-entries
@vindex calendar-mark-diary-entries-flag
  より広い視点でダイアリーが記載されている日を知るには、@kbd{m}コマンドを使用します。これはダイアリーエントリーをもつ日付を、異なるフェイスでマークします。
@iftex
@ref{Calendar Customizing,,, emacs-xtra, Specialized Emacs
Features}を参照してください。
@end iftex
@ifnottex
@ref{Calendar Customizing, diary-entry-marker}を参照してください。
@end ifnottex

  このコマンドは現在表示されている月と、スクロールすることにより表示される月の両方に適用されます。マークを消すには@kbd{u}をタイプします。これにより休日のマークもオフになります(@ref{Holidays}を参照してください)。変数@code{calendar-mark-diary-entries-flag}が非@code{nil}の場合、カレンダーの作成または更新により、ダイアリーの日付が自動的にマークされます。

@kindex s @r{(Calendar mode)}
@findex diary-show-all-entries
  限られたエントリーだけでなく、ダイアリーファイル全体を参照するには、@kbd{s}コマンドを使用します。

@findex diary
  コマンド@kbd{M-x
diary}は、カレンダーの表示とは独立に、その日のダイアリーエントリーと、オプションでその後の何日かのダイアリーエントリーも同様に表示します。何日分を含めるかは変数@code{diary-number-of-entries}で指定してください。
@iftex
@ref{Diary Customizing,,, emacs-xtra, Specialized Emacs Features}を参照してください。
@end iftex
@ifnottex
@ref{Diary Customizing, diary-number-of-entries}を参照してください。
@end ifnottex

  @file{.emacs}ファイルに@code{(diary)}を記述した場合、Emacsを開始したときに、その日のダイアリーエントリーのウィンドウを自動的に表示します。

@findex diary-mail-entries
@vindex diary-mail-days
  ダイアリーのイベント通知を、メールで受けとるのを好む人もいます。そのようなメールをあなた自身に送るには、コマンド@kbd{M-x
diary-mail-entries}を使用します。プレフィクス引数は、(今日から開始して)何日分をチェックするかを指定します。プレフィクス引数を指定しない場合、変数@code{diary-mail-days}により、何日分をチェックするかが指定されます。

@node Format of Diary File
@subsection ダイアリーファイル
@cindex diary file

@vindex diary-file
  @dfn{ダイアリーファイル(diary
file)}とは、特定の日付に関連付けられたイベントを記録するファイルです。ダイアリーファイルの名前は、変数@code{diary-file}により指定されます。デフォルトは@file{~/diary}です。@code{calendar}ユーティリティープログラムは、Emacsダイアリー機能により認められた形式のサブセットをサポートするので、このユーティリティーを使って、(エントリー自体は理解できないかもしれませんが)適切にダイアリーファイルを閲覧できます。

  ダイアリーファイルの各エントリーは、1つ以上の行からなる1つのイベントを記述します。エントリーは、常に左端の日付指定で開始されます。エントリーの残りの部分は、イベントを説明するテキストです。エントリーが複数行の場合、2行目以降はそれが前のエントリーの継続行であることを示すために、空白文字で開始しなければなりません。有効な日付で開始されておらず、前のエントリーの継続行でもない行は無視されます。

  ダイアリーエントリーの最初の行が、日付または曜日名(後にブランクも句読点もない)だけの形式を使うこともできます。たとえば:

@example
02/11/2012
      Bill B. visits Princeton today
      2pm Cognitive Studies Committee meeting
      2:30-5:30 Liz at Lawrenceville
      4:00pm Dentist appt
      7:30pm Dinner at George's
      8:00-10:00pm concert
@end example

@noindent
このエントリーは、シンプルなダイアリー表示を使ったときは、異なる表示になります
@iftex
(@ref{Diary Display,,, emacs-xtra, Specialized Emacs Features}を参照してください)。
@end iftex
@ifnottex
(@ref{Diary Display}を参照してください)。
@end ifnottex
シンプルなダイアリー表示は最初の日付行を省略して、継続行だけが表示されます。このスタイルのエントリーは、1日分だけのエントリーを表示するときはうまく表示されますが、複数日のエントリーの場合は混乱するかもしれません。

@vindex diary-nonmarking-symbol
  カレンダーウィンドウで、特定のダイアリーエントリーのマークを抑止することができます。これを行なうには、エントリーの開始、日付の前に、@code{diary-nonmarking-symbol}で指定された文字列(デフォルトは@samp{&})を挿入します。これはエントリーをダイアリーウィンドウで表示する場合は、影響ありません。カレンダーウィンドウで日付をマークするときだけ影響があります。マークされないエントリーは、マークの数が多くなりすぎるような、一般的なエントリーにたいして有用です。

@node Date Formats
@subsection 日付のフォーマット

  以下は、異なる方法でフォーマットされた日付を説明するために、ダイアリーエントリーの例をいくつか示したものです。この例では、日付はすべてアメリカ形式(月、日、年)ですが、Calendarモードは、オプションでヨーロッパ形式(日、月、年)と、ISO形式(年、月、日)をサポートします。

@example
4/20/12  Switch-over to new tabulation system
apr. 25  Start tabulating annual results
4/30  Results for April are due
*/25  Monthly cycle finishes
Friday  Don't leave without backing up files
@end example

  最初のエントリーは、2012年4月20日に1度だけ表示されます。2番目と3番目のエントリーは毎年、指定した日に表示され、4番目のエントリーは月にワイルドカード(アスタリスク)を使っているので、毎月25日に表示されます。最後のエントリーは毎週、金曜日に表示されます。

  @samp{@var{month}/@var{day}}や@samp{@var{month}/@var{day}/@var{year}}のように、日付を表すのに数字だけを使うこともできます。この場合、その後に続く文字は数字以外の文字でなければなりません。日付の@var{month}と@var{day}は、1桁または2桁の数字です。オプションの@var{year}も数字で、省略形として最後の2桁を使うこともできます。つまり、@samp{11/12/2012}または@samp{11/12/12}を使うことができます。

  日付は、@samp{@var{monthname} @var{day}}または@samp{@var{monthname} @var{day},
@var{year}}という形式をもつこともできます。月の名前のスペルには完全形、または省略形(最後のピリオドはあってもなくてもよい)を指定できます。月または曜日の優先される省略形は、変数@code{calendar-abbrev-length}、@code{calendar-month-abbrev-array}、@code{calendar-day-abbrev-array}を使ってセットできます。デフォルトは、名前の最初の3文字を省略形として使用します。大文字小文字に違いはありません。

  日付は@dfn{ジェネリック(generic)} ---
つまり指定されていない部分があっても構いません。この場合、エントリーは日付に指定された部分にマッチする、すべての日付に適用されます。日付が年を含まない場合、これはジェネリックで、任意の年に適用されます。かわりに@var{month}、@var{day}、@var{year}に@samp{*}を使用することもできます。これは任意の月、任意の日、任意の年にマッチします。したがって、日付は@samp{3/*/*}のダイアリーエントリーは任意の年の3月の任意の日にマッチします。@samp{march
*}も同じです。

@vindex calendar-date-style
@findex calendar-set-date-style
  ヨーロッパ形式(月の前に日を記述する)、またはISO形式(年、月、日の順で記述する)で日付を記述したい場合は、カレンダーで@kbd{M-x
calendar-set-date-style}とタイプするか、変数@code{calendar-date-style}をカスタマイズします。これはダイアリーの日付がどのように解釈されるか、日付の表示、コマンドが与えられた引数に要求する順序に影響を与えます。

  週のある曜日に適用されるジェネリックな日付として、曜日名を使うことができます。曜日名は完全なスペルを記述するか、上述した省略形を使用できます。大文字小文字に違いはありません。

@node Adding to Diary
@subsection ダイアリーに追加するコマンド

  カレンダーでは、ダイアリーのエントリーを作成するコマンドがいくつかあります。以下は基本的なコマンドの一覧です。より複雑なコマンドは次のセクションで説明します((@ref{Special
Diary Entries}を参照してください))。エントリーにはグレゴリオ暦以外も使用できます。
@iftex
@ref{Non-Gregorian Diary,,, emacs-xtra, Specialized Emacs
Features}を参照してください。
@end iftex
@ifnottex
@ref{Non-Gregorian Diary}を参照してください。
@end ifnottex

@table @kbd
@item i d
選択された日付のダイアリーエントリーを追加します(@code{diary-insert-entry})。
@item i w
選択された曜日のダイアリーエントリーを、各週に追加します(@code{diary-insert-weekly-entry})。
@item i m
選択された日のダイアリーエントリーを、各月に追加します(@code{diary-insert-monthly-entry})。
@item i y
選択された日のダイアリーエントリーを、各年に追加します(@code{diary-insert-yearly-entry})。
@end table

@kindex i d @r{(Calendar mode)}
@findex diary-insert-entry
  カレンダーウィンドウで日付を選択して、@kbd{i
d}コマンドをタイプすることにより、特定の日付にたいするダイアリーエントリーを作成することができます。このコマンドは、ダイアリーファイルの最後の部分を別のウィンドウに表示して、その日付を追加します。その後、ダイアリーエントリーの残りの部分をタイプできます。

@kindex i w @r{(Calendar mode)}
@findex diary-insert-weekly-entry
@kindex i m @r{(Calendar mode)}
@findex diary-insert-monthly-entry
@kindex i y @r{(Calendar mode)}
@findex diary-insert-yearly-entry
  毎週、特定の曜日に適用されるダイアリーエントリーを作成したいときは、その曜日(同じ曜日ならどの日でも構いません)を選択して、@kbd{i
w}とタイプします。これは曜日をジェネリックな日付として挿入します。そのあとダイアリーエントリーの残りの部分をタイプできます。月ごとのダイアリーエントリーも同じやり方で作成できます。まず月のある日付を選択して、@kbd{i
m}コマンドを使い、その後エントリーの残りの部分をタイプします。同様に@kbd{i y}コマンドで、年ごとのダイアリーエントリーを挿入できます。

  上記のすべてのコマンドは、デフォルトでマークされるダイアリーエントリーを作成します。マークされないダイアリーエントリーを作成するには、コマンドにプレフィクス引数を与えます。たとえば、@kbd{C-u
i w}は、マークされない週次のダイアリーエントリーを作成します。

  ダイアリーファイルを変更したときは、Emacsを終了する前にそのファイルを保存してください。上記の挿入コマンドを使用した後でダイアリーファイルを保存することにより、それが適切な場合は、カレンダーウィンドウのダイアリーのマークを自動的に更新します。随時に更新させるには、コマンド@code{calendar-redraw}を使うことができます。

@node Special Diary Entries
@subsection 特別なダイアリーエントリー

  カレンダーの日付にもとづくエントリーに加え、ダイアリーファイルは記念日のような定期的なイベントにたいする、@dfn{sexpエントリー(sexp
entries:
S式エントリー)}を含むことができます。これらのエントリーは、Emacsがダイアリーファイルをスキャンすることにより評価される、Lisp式(sexp)にもとづきます。日付のかわりに、sexpエントリーは@samp{%%}と、その後ろに続くLisp式を含んでおり、Lisp式はカッコで始まりカッコで終わらなければなりません。Lisp式は、エントリーが適用される日付を決定します。

  Calendarモードは、一般的に使用される特定のsexpエントリーを挿入するためのコマンドを提供します:

@table @kbd
@item i a
選択された日付にたいして、記念日ダイアリーエントリー(anniversary diary entry)を追加します。
@item i b
カレントリージョンにたいして、ブロックダイアリーエントリー(block diary entry)を追加します。
@item i c
その日付に開始される、周期的ダイアリーエントリー(cyclic diary entry)を追加します。
@end table

@kindex i a @r{(Calendar mode)}
@findex diary-insert-anniversary-entry
  特定の日付の記念日に適用されるダイアリーエントリーを作成したい場合は、ポイントをその日付に移動して@kbd{i
a}コマンドを使用します。これはダイアリーファイルの最後の部分を別のウィンドウに表示して、記念日の記述を追加します。その後ダイアリーエントリーの残りの部分をタイプできます。エントリーは以下のようになります:

@findex diary-anniversary
@example
%%(diary-anniversary 10 31 1948) Arthur's birthday
@end example

@noindent
このエントリーは、1948年以降の任意の年の10月31日に適用されます。@samp{10 31
1948}は日付を指定します(ヨーロッパ形式またはISO形式を使用している場合、入力順は月、日、年とは異なります)。この式が開始年を要求する理由は、ダイアリーの上級機能が、経過年数を計算できるようにするためです。

  @dfn{ブロック}ダイアリーエントリーは、特定の連続する日付範囲に適用されます。以下は2012年6月24日から2012年7月10日までの、すべての日付に適用されるブロックダイアリーエントリーです:

@findex diary-block
@example
%%(diary-block 6 24 2012 7 10 2012) Vacation
@end example

@noindent
@samp{6 24 2012}は開始日付を示し、@samp{7 10
2012}は終了日付を示します(繰り返しになりますが、ヨーロッパ形式またはISOカレンダー形式を使用している場合、月、日、年の順は異なります)。

@kindex i b @r{(Calendar mode)}
@findex diary-insert-block-entry
  ブロックエントリーを入力するには、開始と終了の範囲となる2つの日付にポイントとマークを配し、@kbd{i
b}とタイプします。このコマンドは、ダイアリーファイルの最後の部分を別のウィンドウに表示して、ブロックの記述を挿入します。その後で、ダイアリーエントリーをタイプすることができます。

@kindex i c @r{(Calendar mode)}
@findex diary-insert-cyclic-entry
   @dfn{周期的(cyclic)}ダイアリーエントリーは、ある固定された日数の期間繰り替えされるエントリーです。これを作成するには、開始日を選択して@kbd{i
c}コマンドを使用します。コマンドは期間の長さの入力を求め、それから以下のようなエントリーを挿入します:

@findex diary-cyclic
@example
%%(diary-cyclic 50 3 1 2012) Renew medication
@end example

@noindent
このエントリーは、2012年3月1日以降の50日間適用されます。@samp{3 1
2012}は開始日の指定です(ヨーロッパ形式またはISOカレンダー形式を使用している場合、月、日、年の入力順は異なります)。

  これら3つのコマンドはすべて、ダイアリーエントリーをマークします。マークしないダイアリーエントリーを挿入するには、プレフィクス引数を与えます。たとえば@kbd{C-u
i a}は、マークされない記念日ダイアリーエントリーを作成します。

  カレンダーでsexpダイアリーエントリーを作成すると、カレンダーウィンドウで表示されているすべての日付にたいして個別にチェックしなければならないので、時間がかかるかもしれません。そのため、可能ならsexpダイアリーエントリーを、(@samp{&}を使って)マークされないようにするのがよいでしょう。

  その他の複雑なsexpエントリーとして、@dfn{浮動(floating)}ダイアリーエントリーがあります。これは日、週、年のオフセットで指定される、定期的に発生するイベントを指定するためのものです。これは@code{cron}により解釈されるcrontabエントリーに類似しています。以下はマークされない、浮動ダイアリーエントリーで、11月の第4木曜日に適用されます。

@findex diary-float
@example
&%%(diary-float 11 4 4) American Thanksgiving
@end example

@noindent
11は11月(11番目の月)を指定し、4は木曜日(週の第4日。日曜日は0)、2番目の4は第4週(1は第1週、2は第2週、@minus{}2は最終週から2番目の週)を指定します。月は1つの月、または月のリストを使用できます。したがって上記の11を@samp{'(1
2
3)}に変更すると、このエントリーは1月、2月、3月の第4木曜日に適用されることになります。月が@code{t}の場合、そのエントリーは年の各月に適用されます。

  標準的なsexpダイアリーエントリーは、フェイス名またはカレンダーをマークするときに使用する1文字の文字列を指定する、オプションのパラメーターを受け取ります。一般的には、sexpダイアリーエントリーは、それらが適用されるときを決定するために、任意の計算を処理することができます。
@iftex
@ref{Sexp Diary Entries,,, emacs-xtra, Specialized Emacs Features}を参照してください。
@end iftex
@ifnottex
@ref{Sexp Diary Entries}を参照してください。
@end ifnottex

@node Appointments
@section アポイントメント
@cindex appointment notification

@vindex appt-display-format
@vindex appt-audible
@vindex appt-display-mode-line
  アポイントメント(appointment:
約束、予約)にたいするダイアリーエントリーがある場合、そのダイアリーエントリーが認識可能な日時で開始されていれば、Emacsは保留されたアポイントメントがあることを警告することができます。Emacsは、変数@code{appt-display-format}で選択されたフォーマットでメッセージを表示して、アポイントメントにたいする注意を喚起します。@code{appt-audible}の値が非@code{nil}の場合、警告には音によるリマインダーも含まれます。加えて、@code{appt-display-mode-line}が非@code{nil}の場合、Emacsはアポイントメントまで何分あるかを、モードラインに表示します。

@vindex appt-display-duration
@vindex appt-disp-window-function
@vindex appt-delete-window-function
  @code{appt-display-format}の値が@code{window}の場合、変数@code{appt-display-duration}がリマインダーウィンドウを表示する長さを制御します。変数@code{appt-disp-window-function}および@code{appt-delete-window-function}は、ウィンドウを生成または破棄する関数の名前を与えます。

@findex appt-activate
  アポイントメントの通知を有効にするには、@kbd{M-x
appt-activate}とタイプします。正の引数は通知を有効に、負の引数は通知を無効に、引数を指定しない場合は通知のオンとオフを切り替えます。通知を有効にすることにより、ダイアリーファイルから見つかった、認識可能な日時をもつすべてのダイアリーエントリーにより、今日のアポイントメントリストをセットアップし、それらのアポイントメントの直前に注意を促します。

  たとえば、ダイアリーファイルに以下のような行が含まれているとします:

@example
Monday
  9:30am Coffee break
 12:00pm Lunch
@end example

@vindex appt-message-warning-time
@vindex appt-warning-time-regexp
@noindent
月曜日には、9:20am頃にコーヒーブレーク、11:50am頃にランチの注意が促されます。変数@code{appt-message-warning-time}には、前もって何分前(デフォルトは12)に警告するかを指定します。これはデフォルトの警告タイムです。@code{appt-warning-time-regexp}に部分マッチングを追加することにより、各アポイントメントに異なる警告タイムを指定できます(詳細は、この変数のドキュメントを参照してください)。

  時刻はam/pmスタイル(@samp{12:00am}は真夜中で、@samp{12:00pm}は正午)、またはヨーロッパ/軍隊の24時間制で記述できます。どちらを使うか一貫性がある必要はありません。ダイアリーファイルで、この2つのスタイルを混交させることができます。時刻が認識されるためは、それがダイアリーエントリーの最初に記述されていなければなりません。

@vindex appt-display-diary
  Emacsは、真夜中直後にダイアリーファイルから自動的にアポイントメントリストを更新します。アポイントメント通知を再度有効にすることにより、随時に更新させることができます。@code{appt-display-diary}を@code{nil}にセットしていなければ、これらのアクションはその日のダイアリーバッファーにも表示されます。アポイントメントリストは、ダイアリーファイル(またはそれをインクルードするファイル。
@iftex
@ref{Fancy Diary Display,,, emacs-xtra, Specialized Emacs
Features}を参照してください)
@end iftex
@ifnottex
@ref{Fancy Diary Display}を参照してください)
@end ifnottex
が保存されたときにも更新されます。

@findex appt-add
@findex appt-delete
@cindex alarm clock
  アラーム時計のように、アポイントメント通知機能を使うこともできます。コマンド@kbd{M-x
appt-add}は、ダイアリーファイルに影響を与えずに、アポイントメントリストにエントリーを追加します。アポイントメントリストからエントリーを削除するには、@kbd{M-x
appt-delete}を使います。

@node Importing Diary
@section ダイアリーエントリーのインポートとエクスポート

  Emacsのダイアリーファイルと、他のさまざまなフォーマットの間で、ダイアリーエントリーを変換できます。

@vindex diary-outlook-formats
  Outlookが生成したアポイントメントメッセージから、ダイアリーエントリーをインポートできます。そのようなメッセージをRmailやGnusで閲覧しているときは、エントリーをインポートするために@kbd{M-x
diary-from-outlook}を実行します。変数@code{diary-outlook-formats}をカスタマイズすることにより、このコマンドに追加のアポイントメッセージ形式を認識させることができます。他のメールクライアントは、@code{diary-from-outlook-function}を適切な値にセットできます。

@c FIXME the name of the RFC is hardly very relevant.
@cindex iCalendar support
  icalendarパッケージにより、Emacsダイアリーファイルと、``RFC 2445 --- Internet Calendaring and
Scheduling Core Object Specification
(iCalendar)''で定義されるiCalendarとの間で、データを変換することができます(初期のvCalendar形式も同様)。

@c  Importing works for ``ordinary'' (i.e., non-recurring) events, but
@c (at present) may not work correctly (if at all) for recurring events.
@c Exporting of diary files into iCalendar files should work correctly
@c for most diary entries.  This feature is a work in progress, so the
@c commands may evolve in future.

@findex icalendar-import-buffer
  コマンド@code{icalendar-import-buffer}は、カレントバッファーからiCalendarデータを抽出して、それをダイアリーファイルに追加します。この関数は、iCalendarデータを自動的に抽出するためにも適しています。たとえばRmailメールクライアントは、以下を使用できます:

@example
(add-hook 'rmail-show-message-hook 'icalendar-import-buffer)
@end example

@findex icalendar-import-file
  コマンド@code{icalendar-import-file}は、iCalendarファイルをインポートして、その結果をEmacsダイアリーファイルに追加します。たとえば:

@example
(icalendar-import-file "/here/is/calendar.ics"
                       "/there/goes/ical-diary")
@end example

@noindent
もし違うファイルが存在する場合は、インポートファイルの内容を追加するために、@code{#include}ディレクティブを使うことができます。
@iftex
@ref{Fancy Diary Display,,, emacs-xtra, Specialized Emacs
Features}を参照してください。
@end iftex
@ifnottex
@ref{Fancy Diary Display}を参照してください。
@end ifnottex


@findex icalendar-export-file, icalendar-export-region
  @code{icalendar-export-file}を使って、Emacsダイアリーファイル全体をiCalendar形式にエクスポートできます。ダイアリーファイルの一部をエクスポートするには、関連する領域をマークして、@code{icalendar-export-region}を呼び出します。どちらの場合も、Emacsは結果をターゲットファイルに追加します。

@node Daylight Saving
@section サマータイム
@cindex daylight saving time

  Emacsは、標準時とサマータイムの違いを理解します。日の出、日の入り、夏至、冬至、春分、秋分、月の位相では、時刻を補正しています。サマータイムのルールは、場所によりさまざまで、歴史的にも異なります。処理を正しく行なうには、Emacsが使用するルールを知る必要があります。

@vindex calendar-daylight-savings-starts
@vindex calendar-daylight-savings-ends
  どこにいるかにより適用されるルールを、追跡するオペレーティングシステムもあります。そのようなシステムでは、Emacsはそのシステムから必要な情報を取得します。これらの情報の一部またはすべてが欠落している場合、Emacsは現在マサチューセッツのケンブリッジで使用されているルールで、そのギャップを埋めます。その結果としてのルールが望むものでない場合、変数@code{calendar-daylight-savings-starts}および@code{calendar-daylight-savings-ends}をセットすることにより、Emacsに使用するルールを指定できます。

  これらの値は、変数@code{year}を参照するLisp式で、サマータイムが開始または終了される、@code{(@var{month}
@var{day}
@var{year})}という形式のリストによる、グレゴリオ暦の日付として評価されます。その地域がサマータイムを使用しない場合、値は@code{nil}であるべきです。

  Emacsは、サマータイムの開始を決定するためにこれらの式を使い、休日リスト、太陽および月に関する時刻の補正を行ないます。

  マサチューセッツのケンブリッジにたいする値は、以下のとおりです:

@example
(calendar-nth-named-day 2 0 3 year)
(calendar-nth-named-day 1 0 11 year)
@end example

@noindent
つまり、@code{year}で指定される年の、3番目の月(3月)の、第2週の0番目の曜日(日曜日)と、、その年の11番目の月(11月)の、第1週の日曜日です。サマータイムが10月1日から開始されるように変更する場合、@code{calendar-daylight-savings-starts}を以下のように変更します:

@example
(list 10 1 year)
@end example

  その地域でサマータイムがない、またはすべての時刻を標準時にしたい場合は、@code{calendar-daylight-savings-starts}と@code{calendar-daylight-savings-ends}を、@code{nil}にセットします。

@vindex calendar-daylight-time-offset
  変数@code{calendar-daylight-time-offset}は、サマータイムと標準時の差を、分で指定します。マサチューセッツのケンブリッジでは60です。

@c @vindex calendar-daylight-savings-starts-time  too long!
@vindex calendar-daylight-savings-ends-time
  最後に、2つの変数@code{calendar-daylight-savings-starts-time}と@code{calendar-daylight-savings-ends-time}は、サマータイムの開始と終了の遷移時に、地方時の真夜中から何分ずれるかを指定します。マサチューセッツのケンブリッジでは、変数の値は両方とも120です。

@node Time Intervals
@section 時間間隔の加算
@cindex time intervals, summing
@cindex summing time intervals
@cindex timeclock

  timeclockパッケージは、時間間隔を加算していくので、(たとえば)特定のプロジェクトにどれだけ時間を費やしているか、追跡することができます。

@findex timeclock-in
@findex timeclock-out
@findex timeclock-change
@findex timeclock-workday-remaining
@findex timeclock-when-to-leave
  プロジェクトの作業を開始したとき@kbd{M-x timeclock-in}コマンドを使用し、作業を終えたら@kbd{M-x
timeclock-out}コマンドを使用します。これを行なうたびに、プロジェクトの記録に時間間隔を追加します。違うプロジェクトの作業に変更する場合は、@kbd{M-x
timeclock-change}を使用します。

  いくつかの時間間隔をからデータを収集したら、@kbd{M-x
timeclock-workday-remaining}を使って、その作業にたいして今日の残り時間を見ることができ(1日の作業時間の平均は通常8時間とみなします)、@kbd{M-x
timeclock-when-to-leave}で作業を終了する時間を計算します。

@vindex timeclock-modeline-display
@findex timeclock-modeline-display
  Emacsにたいして、モードラインに作業日の残り時間を表示させたいときは、変数@code{timeclock-modeline-display}を@code{t}にセットするか、コマンド@kbd{M-x
timeclock-modeline-display}を呼び出します。

@vindex timeclock-ask-before-exiting
  Emacsのカレントセッションを終了することは、そのプロジェクトの作業を終えることを意味するか不明なので、デフォルトではEmacsは確認を求めます。しかし変数@code{timeclock-ask-before-exiting}の値を@code{nil}にカスタマイズすることにより、確認を無視できます。その場合、明示的に@kbd{M-x
timeclock-out}か@kbd{M-x
timeclock-change}を呼び出した場合だけ、カレントの時間間隔が終了したとEmacsに告げます。

@cindex @file{timelog} file
@vindex timeclock-file
@findex timeclock-reread-log
  timeclock関数は、@file{~/.emacs.d/timelog}と呼ばれるファイルに、データを集積することにより機能します。変数@code{timeclock-file}をカスタマイズすることにより、このファイルに違う名前を指定できます。手作業でtimeclockを編集したり、timeclockのカスタマイズ可能な変数の値を変更したときは、コマンド@kbd{M-x
timeclock-reread-log}を実行するべきです。

@ifnottex
@include cal-xtra.texi
@end ifnottex
